---
interface Props {
	title: string;
	description: string;
	image?: string;
	imageAlt?: string;
	publishedDate?: string;
	modifiedDate?: string;
	author?: {
		name: string;
		role?: string;
	};
	tags?: string[];
	type?: 'website' | 'article';
	canonicalURL?: string;
}

const {
	title,
	description,
	image,
	imageAlt,
	publishedDate,
	modifiedDate,
	author,
	tags = [],
	type = 'website',
	canonicalURL,
} = Astro.props;

const siteUrl = 'https://tenxafrica.co.za';
const currentURL = canonicalURL || new URL(Astro.url.pathname, siteUrl).href;
const ogImage = image || `${siteUrl}/og-default.jpg`;

// Structured data for articles
const structuredData = type === 'article' && publishedDate ? {
	'@context': 'https://schema.org',
	'@type': 'BlogPosting',
	headline: title,
	description: description,
	image: ogImage,
	datePublished: publishedDate,
	dateModified: modifiedDate || publishedDate,
	author: author ? {
		'@type': 'Person',
		name: author.name,
		jobTitle: author.role,
	} : {
		'@type': 'Organization',
		name: 'Ten X Africa',
		url: siteUrl,
	},
	publisher: {
		'@type': 'Organization',
		name: 'Ten X Africa',
		url: siteUrl,
		logo: {
			'@type': 'ImageObject',
			url: `${siteUrl}/logo.png`,
		},
	},
	mainEntityOfPage: {
		'@type': 'WebPage',
		'@id': currentURL,
	},
	keywords: tags.join(', '),
} : null;
---

<!-- Canonical URL -->
<link rel="canonical" href={currentURL} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={currentURL} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={ogImage} />
{imageAlt && <meta property="og:image:alt" content={imageAlt} />}
<meta property="og:site_name" content="Ten X Africa" />
{publishedDate && <meta property="article:published_time" content={publishedDate} />}
{modifiedDate && <meta property="article:modified_time" content={modifiedDate} />}
{author && <meta property="article:author" content={author.name} />}
{tags.map(tag => <meta property="article:tag" content={tag} />)}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={currentURL} />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImage} />
{imageAlt && <meta name="twitter:image:alt" content={imageAlt} />}

<!-- Structured Data (JSON-LD) -->
{structuredData && (
	<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />
)}

<!-- Additional SEO Meta Tags -->
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
<meta name="googlebot" content="index, follow" />
